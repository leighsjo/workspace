% clear all;function createCroppedSepiaImage(imName)path = '/Users/leixu/Documents/Administration/GroupMembers/Website/';% imName = 'Federico.jpg';filename = [path,imName(1:end-4), '_sepiaCropped.png'];im = imread([path,imName]);[r, c, ~] = size(im);% [~,BB] = faceDetect(im);% coor = min(BB(1:2))if r~=c && rem(max(r,c)-(min(r,c)), 2) ==0  switch (r > c)  case 1%    im = padarray(im,[0 (r-c)/2],0,'both');    im = im((r-c)/2+1:(r+c)/2,:,:);  case 0%    im = padarray(im,[(c-r)/2 0],0,'both');    im = im(:,(c-r)/2+1:(r+c)/2,:);  endelseif r~=c && rem(max(r,c)-(min(r,c)), 2) ==1  switch (r > c)  case 1%    im = padarray(im,[0 (r-c-1)/2],0,'pre');%    im = padarray(im,[0 (r-c+1)/2],0,'post');    im = im((r-c+1)/2:(r+c-1)/2,:,:);  case 0%    im = padarray(im,[(c-r-1)/2 0],0,'pre');%    im = padarray(im,[(c-r+1)/2 0],0,'post');     im = im(:,(c-r+1)/2:(r+c-1)/2,:,:);  end end%darkening = 0.8;im_r = double(im(:,:,1));im_g = double(im(:,:,2));im_b = double(im(:,:,3));Coef = [0.393, 0.769, 0.189; 0.349, 0.686, 0.168; 0.272, 0.534, 0.131];radius = min(r,c)/2;mask = genDisk(im_r,radius, round(min(r,c)/2), round(min(r,c)/2));mask(mask)=1;sepiaIm_r  = (im_r.*Coef(1,1) + im_g.*Coef(1,2) + im_b.*Coef(1,3)).*mask*darkening;sepiaIm_g  = (im_r.*Coef(2,1) + im_g.*Coef(2,2) + im_b.*Coef(2,3)).*mask*darkening;sepiaIm_b  = (im_r.*Coef(3,1) + im_g.*Coef(3,2) + im_b.*Coef(3,3)).*mask*darkening*1.05;sepiaIm = uint8(cat(3,sepiaIm_r, sepiaIm_g, sepiaIm_b));figure,imshow(sepiaIm);Alpha = zeros(size(sepiaIm_r));Alpha(mask) = 1;imwrite(sepiaIm,filename,'png','Alpha',Alpha);end